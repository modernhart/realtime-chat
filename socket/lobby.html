<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
</head>
<body>
<button id="joinroom" type="button">join the room</button>
</body>
<script>

//접속자 랜덤 이름 부여
function randUser(){
	var name = "user";

	//1~100까지의 랜덤숫자
	var randn = parseInt((Math.random()*100)+1);
	var num = randn.toString();
	return name+num;
}

$(function(){

	//클라이언트 스크립트
	var socket = io();
	var name = "";
	socket.emit("login",{
		name : randUser()
	});

	socket.on('login',function(data){
		$("#chat").append("<p>"+data+" has joined!</p>");
	});

	$("form").submit(function(e){
		e.preventDefault();
		var msg = $("#msgForm");

		socket.emit('chat',{msg : msg.val(), name: name});
		msg.val("");
	});

	socket.on('chat',function(data){
		$("#chat").append("<p style='color:blue;'>"+data.name+" : "+data.msg+"</p>");
	});
	socket.on('disconnect',function(data){
		$("#chat").append("<p style='color:red;'>"+data+" has left </p>");
	});

});
</script>
</html>
